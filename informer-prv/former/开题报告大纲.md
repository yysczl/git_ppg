## 数据说明
使用的情绪脉搏信号数据集是在虚拟现实情绪场景刺激下采集的脉搏数据，包括平静情绪的、悲伤情绪的、快乐情绪的、恐惧情绪的和紧张情绪的 5 种原始脉搏信号，标签为志愿者填写的 DASS-21 心理压力自评量表分数和焦虑量表分数
### PPG数据
PPG数据文件位于 `dataset/PPG/` 目录下，包含90名试验者的数据：
- 每行代表一个试验者
- 前1800列为脉搏波数据点（时序特征）
- 最后一列为量表压力数值（标签值）
### PRV数据
PRV数据文件位于 `dataset/PRV/` 目录下，包含90名试验者的数据：
- 每行代表一个试验者
- 前80列为脉率变异性数据点（时序特征）
- 最后一列为量表压力数值（标签值）
- PRV信号作为PPG的高阶特征，包含心率变异性中与自主神经系统相关的压力指标
## 支持的情绪类型
- Anxiety（焦虑）
- Happy（快乐）
- Peace（平静）
- Sad（悲伤）
- Stress（压力）

# 开题报告题目
《PPG-Former-DualStream：融合多尺度时频Transformer与双流协同网络的多任务心理压力预测方法研究》
备选题目：
《基于生理周期感知Transformer的PPG-PRV双模态心理压力预测研究》
《多尺度时频融合与跨模态交互的可穿戴压力监测方法研究》
## 一、选题背景与研究意义
### 1.1 研究背景
心理压力是现代社会中影响人类身心健康的重要因素之一，世界卫生组织调查显示，全球约有35%的人群长期处于压力状态，长期处于高压力状态可能导致心血管疾病、抑郁症、焦虑障碍等多种身心疾病1-3。因此，实现心理压力的客观、实时、无创监测具有重要的公共卫生意义。
光电容积脉搏波（Photoplethysmography, PPG）是一种通过光学方法采集的生理信号，能够反映心血管系统的动态变化4。近年来，随着智能可穿戴设备的普及，基于PPG信号的压力监测逐渐成为研究热点5-6。脉率变异性（Pulse Rate Variability, PRV）是从PPG信号中提取的重要生理指标，作为PPG信号的高阶特征，与心率变异性（HRV）高度相关，被广泛用于评估自主神经系统活动7-8。研究表明，PPG和PRV信号中蕴含丰富的与心理压力相关的信息，为非侵入式压力检测提供了可能26-27。
近年来，深度学习在时序数据分析领域取得了显著进展9-10。
Transformer模型凭借自注意力机制在自然语言处理领域取得巨大成功，并逐步扩展到时序预测任务11。2021年提出的Informer模型通过引入ProbSparse自注意力机制，有效解决了标准Transformer在长序列预测中的效率问题12。然而，现有方法多直接将通用时序模型应用于生理信号，未充分考虑PPG信号的周期性、时频特性等领域特点，限制了模型性能的进一步提升。
### 1.2 研究意义
#### 理论意义：
1. 提出生理周期感知位置编码，为Transformer在生理信号领域的应用提供新思路
2. 设计多尺度时频融合注意力机制，丰富时序深度学习的理论方法
3. 构建跨模态交互的双流网络架构，推动多模态生理信号融合研究
#### 实践意义：
1. 为智能可穿戴设备的压力监测功能提供技术支撑
2. 实现心理压力的实时量化评估，支持个性化健康干预
3. 在数字健康、运动监测、心理咨询等领域具有广阔应用前景
## 二、国内外研究现状
### 2.1 基于生理信号的压力识别研究
1. 生理信号：
  传统的压力识别方法主要基于心电图（ECG）、皮肤电导（GSR）、肌电图（EMG）等多种生理信号31。PPG信号因其采集便捷、成本低廉的优势，近年来受到广泛关注32。然而，现有研究多采用传统机器学习方法或简单的深度学习模型，对长序列PPG信号的建模能力有限。
2. 传统机器学习方法：
  早期研究主要采用手工特征提取结合传统分类器。Healey等13在驾驶场景下利用多模态生理信号进行压力识别，采用SVM分类器取得了较好效果。Schmidt等14发布了WESAD数据集，成为压力识别的重要基准。这些方法依赖手工特征设计，泛化能力有限。
3. 深度学习方法：
  近年来，深度学习方法逐渐成为主流。Can等15利用CNN和LSTM对PPG信号进行压力分类。Bobade等16提出了基于多模态融合的实时压力检测系统。然而，现有方法多采用通用网络结构，未针对生理信号特性进行优化设计。
### 2.2 时序深度学习模型研究
1. 循环神经网络：
  LSTM17通过门控机制解决了RNN的梯度消失问题，被广泛应用于时序建模。GRU18进一步简化了门控结构，在保持性能的同时提高了计算效率。
2. 卷积神经网络：
  TCN19采用因果卷积和残差连接，在长序列建模中表现出色。WaveNet20通过扩张卷积扩大感受野，适用于音频等信号处理。
3. Transformer模型：
  Vaswani等11提出的Transformer通过自注意力机制实现了序列中任意位置的直接依赖建模。Informer12通过ProbSparse注意力降低了计算复杂度。Autoformer21和FEDformer22分别引入自相关机制和频域增强，提升了时序预测性能。
### 2.3 多模态融合研究
多模态融合在情感计算领域受到广泛关注。Zadeh等23提出Tensor Fusion Network实现多模态表示学习。Han等24利用注意力机制进行多模态情感分析。在生理信号领域，Koldijk等25探索了多模态压力识别方法。
### 2.4 研究现状总结
现有研究存在以下不足：
1. 未充分利用PPG信号的生理周期特性
2. 时频域特征提取不够全面
3. 多模态融合机制较为简单
4. 多任务学习在压力预测中应用不足
## 三、研究内容与技术方案
### 3.1 研究目标
本研究旨在：
1. 提出面向生理信号的PPG-Former多尺度时频融合Transformer架构
2. 构建PPG-PRV双流协同网络，实现跨模态特征交互
3. 设计多任务联合学习框架，提升模型泛化能力
4. 建立可靠的心理压力量化预测系统
### 3.2 研究内容
#### 研究内容一：PPG-Former多尺度时频融合Transformer
- 生理周期感知位置编码：融入心跳周期先验知识（60-100bpm），使模型在训练初期就具备对PPG信号周期性的感知能力
- 多尺度时频融合注意力：同时在时域和频域计算注意力，通过多尺度卷积捕获不同时间跨度的特征模式
- 压力感知门控机制：采用通道-空间双重门控，自适应选择与压力相关的特征成分
#### 研究内容二：Dual-Stream双流协同网络
- PRV轻量化编码器：针对PRV信号的特点，设计卷积+Transformer的混合编码器
- 跨模态交互注意力：实现PPG和PRV特征的双向信息交互，充分利用模态间的互补性
- 自适应权重融合：根据输入特征动态学习最优的模态融合权重
#### 研究内容三：多任务联合学习框架
- 共享特征表示：通过共享底层特征促进任务间知识迁移
- 压力回归+情绪分类：同时优化主任务和辅助任务
- 不确定性加权损失：自动学习任务权重，避免手动调参
#### 研究内容四：实验验证与系统实现
- 在自建PPG/PRV数据集上进行实验验证
- 与Informer、LSTM、TCN等基准模型对比
- 开展消融实验验证各模块有效性
- 实现压力预测原型系统
### 3.3 技术路线
graph TD
    A["数据采集与预处理"] --> B["PPG信号处理"]
    A --> C["PRV特征提取"]
    
    B --> D["PPG-Former开发"]
    D --> D1["生理位置编码"]
    D --> D2["时频融合注意力"]
    D --> D3["压力感知门控"]
    
    C --> E["PRV Encoder开发"]
    
    D --> F["Dual-Stream融合"]
    E --> F
    F --> F1["跨模态交互注意力"]
    F --> F2["自适应权重融合"]
    
    F --> G["Multi-Task Head"]
    G --> G1["压力回归"]
    G --> G2["情绪分类"]
    G --> G3["不确定性加权"]
    
    G --> H["实验与评估"]
    H --> I["系统实现"]
### 3.4 架构设计思路
本研究提出了一种名为PPG-Former-DualStream的多任务心理压力预测模型，该模型创新性地融合了三大核心模块：
graph LR
    A["PPG原始信号"] --> B["PPG-Former Encoder"]
    C["PRV信号"] --> D["PRV Encoder"]
    B --> E["Dual-Stream Fusion"]
    D --> E
    E --> F["Multi-Task Head"]
    F --> G["压力回归"]
    F --> H["情绪分类"]
核心设计理念：
层次	模块	功能
第一层	PPG-Former	提取PPG信号的多尺度时频特征
第二层	PRV Encoder	编码PRV的心率变异性特征
第三层	Dual-Stream Fusion	跨模态特征交互与融合
第四层	Multi-Task Head	联合优化多个相关任务
### 3.5 创新点
创新点一：提出生理周期感知位置编码
- 首次将心跳周期先验知识融入Transformer的位置编码设计
- 增强模型对PPG信号周期性特征的感知能力
- 相比标准位置编码更适合生理信号建模
创新点二：设计多尺度时频融合注意力机制
- 创新性地同时在时域和频域计算注意力
- 多尺度卷积捕获不同时间跨度的特征模式
- 自适应学习时频特征的最优融合权重
创新点三：构建跨模态交互的双流协同网络
- 设计双向交叉注意力实现PPG-PRV信息交互
- 门控机制控制跨模态信息融合程度
- 自适应权重融合适应个体差异
创新点四：提出不确定性加权的多任务学习框架
- 联合优化压力回归和情绪分类任务
- 不确定性加权自动平衡任务损失
- 共享特征表示提升模型泛化能力
## 四、各模块详细方案
### 4.1 PPG-Former 模块
#### 4.1.1 生理周期感知位置编码
实现方案：标准位置编码 + 心跳周期编码 = 生理感知位置编码
具体做法：
- 基础位置编码采用正弦/余弦函数：PE(pos,2i) = sin(pos/10000^(2i/d))
- 叠加心跳周期编码：根据人体正常心率范围(60-100bpm)，计算平均心跳周期约为0.75秒
- 假设采样率为20Hz，则一个心跳周期约对应15个采样点
- 在位置编码的前1/4维度上叠加心跳周期的正弦编码
为什么这样做：
1. PPG信号具有强周期性：心脏每次搏动产生一个脉搏波，标准位置编码无法感知这种生理周期
2. 增强周期特征捕获：使模型在训练初期就具备对心跳周期的感知能力
3. 加速模型收敛：通过先验知识引导，减少模型从零学习周期模式的负担
优势：
1. 相比标准Transformer的位置编码，更适合生理信号建模
2. 利用领域知识提升特征表达能力
3. 对不同心率范围具有自适应能力
#### 4.1.2 多尺度时频融合注意力
实现方案：输入信号 → [多尺度卷积分支] + [时域注意力分支] + [频域注意力分支] → 融合输出
具体做法：
(1) 多尺度卷积分支
- 使用4种不同大小的卷积核（1×1, 3×3, 5×5, 7×7）
- 每个尺度提取d_model/4维特征
- 拼接后通过1×1卷积融合为d_model维
(2) 时域注意力分支
- 采用标准多头自注意力机制
- 捕获序列中任意两点的时域依赖关系
(3) 频域注意力分支
- 对输入进行FFT变换到频域
- 计算频域特征的幅度谱
- 通过线性层增强频域特征
- 插值回原始时域长度
(4) 自适应融合
- 学习时域权重λt和频域权重λf
- 输出 = λt × 时域特征 + λf × 频域特征 + 多尺度特征
为什么这样做：
1. PPG信号的多尺度特性：
  - 短期变化：反映单个心跳的形态特征（上升支、下降支、重搏波）
  - 中期变化：反映呼吸调制（约0.1-0.4Hz）
  - 长期变化：反映自主神经调节
2. 时频域互补性：
  - 时域：捕获瞬态变化和局部模式
  - 频域：捕获周期性成分和频率分布
  - 压力状态在两个域都有特征表现
3. 自适应权重学习：
  - 不同个体的PPG信号特性不同
  - 让模型自动学习最优的时频融合比例
优势：
- 全面捕获PPG信号的时频特征
- 多尺度感受野覆盖不同时间跨度的模式
- 可解释性强：可分析时频权重了解模型决策依据
#### 4.1.3 压力感知门控机制
实现方案：输入 → 通道注意力门 × 空间注意力门 → 输出
具体做法：
(1) 通道注意力门
- 对序列维度全局平均池化
- 通过两层全连接网络（降维→ReLU→升维）
- Sigmoid激活得到通道权重
- 对每个通道进行加权
(2) 空间注意力门
- 使用7×1的一维卷积
- Sigmoid激活得到每个时间点的权重
- 对每个时间位置进行加权
为什么这样做：
1. 特征选择性：
  - 并非所有特征都与压力相关
  - 门控机制可以抑制无关特征，增强压力相关特征
2. 双重注意力：
  - 通道维度：选择哪些特征通道更重要
  - 空间维度：选择哪些时间点更重要
3. 灵感来源：类似于CBAM注意力模块，但针对1D时序数据优化
优势：
- 提高模型的特征选择能力
- 增强与压力相关的信号成分
- 提供一定的可解释性（可视化注意力权重）
### 4.2 PRV Encoder 模块
实现方案：PRV信号 → 输入投影 → 时序卷积 → Transformer编码 → 输出特征
具体做法：
1. 输入投影层：将PRV特征维度映射到d_model维度
2. 时序卷积层：两层1D卷积提取局部时序模式
3. Transformer编码器：2层TransformerEncoder捕获全局依赖
为什么这样做：
1. PRV信号特点：
  - 序列较短（80个时间点）
  - 已经是高阶特征（从PPG提取的心率变异性）
  - 不需要像PPG那样复杂的编码器
2. 卷积+Transformer组合：
  - 卷积：快速提取局部模式，计算效率高
  - Transformer：建模全局依赖，捕获长程关系
优势：
- 轻量级设计，计算开销小
- 充分利用PRV信号的特性
- 与PPG-Former的输出维度对齐，便于后续融合
### 4.3 Dual-Stream Fusion 模块
实现方案：PPG特征 ←→ PRV特征  (双向交叉注意力)
#### 4.3.1 跨模态交互注意力
具体做法：
1. PPG增强：以PPG特征为Query，PRV特征为Key/Value
  - PPG_enhanced = Attention(Q=PPG, K=PRV, V=PRV)
2. PRV增强：以PRV特征为Query，PPG特征为Key/Value
  - PRV_enhanced = Attention(Q=PRV, K=PPG, V=PPG)
3. 门控融合：
  - 学习门控参数控制增强信息的融入程度
  - PPG_out = PPG + gate_ppg × PPGenhanced
  - PRV_out = PRV + gate_prv × PRV_enhanced
为什么这样做：
1. 双模态互补性：
  - PPG：原始波形信息，包含完整的形态特征
  - PRV：高阶统计信息，反映自主神经系统活动
  - 两者包含不同维度的压力相关信息
2. 双向交互：
  - 单向注意力会造成信息流不平衡
  - 双向注意力使两个模态可以相互增强
3. 门控机制：
  - 防止过度融合导致特征污染
  - 让模型自适应决定融合程度
优势：
- 充分利用双模态的互补信息
- 灵活的信息交互机制
- 保持各模态的独立性同时实现融合
#### 4.3.2 自适应权重融合
实现方案：
[PPG全局特征, PRV全局特征] → 权重预测网络 → [w_ppg, w_prv]
融合特征 = w_ppg × PPG + w_prv × PRV
具体做法：
1. 对PPG和PRV特征分别进行全局平均池化
2. 拼接后通过两层MLP预测融合权重
3. Softmax归一化确保权重和为1
4. 加权求和得到最终融合特征
为什么这样做：
1. 个体差异：
  - 不同人的PPG和PRV信号质量不同
  - 固定权重无法适应个体差异
2. 数据自适应：
  - 在信号质量好的模态上分配更高权重
  - 根据输入特征动态调整
优势：
- 自适应的融合策略
- 提高模型的泛化能力
- 对信号质量差异具有鲁棒性
### 4.4 Multi-Task Head 模块
实现方案：
融合特征 → 共享层 → [压力回归头] + [情绪分类头]
          ↓
      不确定性加权损失
具体做法：
1. 共享表示层：一层MLP提取任务共享特征
2. 压力回归头：两层MLP预测连续压力值
3. 情绪分类头：两层MLP预测情绪类别（5类）
4. 不确定性加权：学习任务权重参数σstress和σemotion
  - Loss = L_stress × exp(-σstress) + σstress + L_emotion × exp(-σemotion) + σemotion
为什么这样做：
1. 任务相关性：
  - 心理压力与情绪状态高度相关
  - 联合学习可以共享底层特征
2. 正则化效果：
  - 辅助任务（情绪分类）可以作为正则项
  - 防止主任务过拟合
3. 不确定性加权：
  - 传统方法需要手动调节任务权重
  - 不确定性加权可自动学习最优权重
优势：
- 提升模型泛化能力
- 减少过拟合风险
- 自动平衡多任务损失
- 可同时获得压力值和情绪预测
## 五、方案优势总结
### 5.1 理论创新优势
创新点	传统方法	本方案	优势
位置编码	标准正弦位置编码	生理周期感知编码	融入领域先验知识
特征提取	单一时域或频域	多尺度时频融合	全面捕获信号特性
特征选择	无选择机制	压力感知门控	增强相关特征
多模态融合	简单拼接	跨模态交互注意力	深度信息交互
任务学习	单任务学习	不确定性加权多任务	提升泛化能力
### 5.2 技术实现优势
1. 端到端训练：整个模型可以端到端优化，无需手工特征工程
2. 模块化设计：各模块可独立替换和优化
3. 可扩展性强：易于添加新的模态或任务
4. 计算效率：相比传统Transformer，多尺度设计减少计算量
### 5.3 应用价值优势
1. 预测精度高：多模态融合提升预测准确性
2. 鲁棒性强：对信号噪声和个体差异具有较好的适应性
3. 可解释性：注意力权重可视化提供决策依据
4. 实用性强：可部署于可穿戴设备进行实时压力监测
## 六、研究方案与可行性分析
### 6.1 研究方案
第一阶段：数据准备与基础研究
- 完成PPG/PRV数据采集与预处理
- 深入调研相关领域前沿进展
- 搭建实验环境和基准模型
第二阶段：模型设计与实现
- 实现PPG-Former多尺度时频融合模块
- 构建Dual-Stream双流协同网络
- 开发多任务联合学习框架
第三阶段：实验与优化
- 开展对比实验和消融实验
- 超参数调优与模型优化
- 结果分析与论文撰写
第四阶段：系统完善与总结
- 实现压力预测原型系统
- 论文修改与完善
- 成果整理与答辩准备
### 6.2 可行性分析

理论可行性：

Transformer在时序建模领域的成功应用为本研究提供了理论基础[11-12]
多尺度卷积和注意力机制在计算机视觉领域的成功经验可迁移到时序信号处理[19-20]
多模态融合和多任务学习在相关领域的研究成果为本研究提供了方法借鉴[23-24, 28]
技术可行性：

深度学习框架（PyTorch/TensorFlow）提供了完善的API支持，便于实现复杂网络结构
自建PPG/PRV数据集包含90名受试者的完整数据，为模型训练和验证提供了数据基础
GPU计算资源可满足模型训练需求，模型结构设计兼顾性能和效率
实施可行性：

研究团队具备生理信号处理和深度学习的专业知识
研究方案采用模块化设计，各模块可独立开发和测试
技术路线清晰，研究计划分阶段实施，风险可控
## 七、参考文献
[1] Cohen S, Janicki-Deverts D, Miller G E. Psychological stress and disease. JAMA, 2007, 298(14): 1685-1687.

[2] Steptoe A, Kivimäki M. Stress and cardiovascular disease. Nature Reviews Cardiology, 2012, 9(6): 360-370.

[3] Schneiderman N, Ironson G, Siegel S D. Stress and health: psychological, behavioral, and biological determinants. Annual Review of Clinical Psychology, 2005, 1: 607-628.

[4] Allen J. Photoplethysmography and its application in clinical physiological measurement. Physiological Measurement, 2007, 28(3): R1-R39.

[5] Gjoreski M, Luštrek M, Gams M, et al. Monitoring stress with a wrist device using context. Journal of Biomedical Informatics, 2017, 73: 159-170.

[6] Peake J M, Kerr G, Sullivan J P. A critical review of consumer wearables, mobile applications, and equipment for providing biofeedback, monitoring stress, and sleep in physically active populations. Frontiers in Physiology, 2018, 9: 743.

[7] Shaffer F, Ginsberg J P. An overview of heart rate variability metrics and norms. Frontiers in Public Health, 2017, 5: 258.

[8] Schäfer A, Vagedes J. How accurate is pulse rate variability as an estimate of heart rate variability? International Journal of Cardiology, 2013, 166(1): 15-29.

[9] Faust O, Hagiwara Y, Hong T J, et al. Deep learning for healthcare applications based on physiological signals: A review. Computer Methods and Programs in Biomedicine, 2018, 161: 1-13.

[10] Torres J F, Hadjout D, Sebaa A, et al. Deep learning for time series forecasting: a survey. Big Data, 2021, 9(1): 3-21.

[11] Vaswani A, Shazeer N, Parmar N, et al. Attention is all you need. NeurIPS, 2017: 5998-6008.

[12] Zhou H, Zhang S, Peng J, et al. Informer: Beyond efficient transformer for long sequence time-series forecasting. AAAI, 2021, 35(12): 11106-11115.

[13] Healey J A, Picard R W. Detecting stress during real-world driving tasks using physiological sensors. IEEE Transactions on Intelligent Transportation Systems, 2005, 6(2): 156-166.

[14] Schmidt P, Reiss A, Du erichen R, et al. Introducing WESAD, a multimodal dataset for wearable stress and affect detection. ICMI, 2018: 400-408.

[15] Can Y S, Chalabianloo N, Ekiz D, et al. Continuous stress detection using wearable sensors in real life: Algorithmic programming contest case study. Sensors, 2019, 19(8): 1849.

[16] Bobade P, Vani M. Stress detection with machine learning and deep learning using multimodal physiological data. ICICC, 2020: 51-57.

[17] Hochreiter S, Schmidhuber J. Long short-term memory. Neural Computation, 1997, 9(8): 1735-1780.

[18] Cho K, Van Merriënboer B, Gulcehre C, et al. Learning phrase representations using RNN encoder-decoder for statistical machine translation. EMNLP, 2014: 1724-1734.

[19] Bai S, Kolter J Z, Koltun V. An empirical evaluation of generic convolutional and recurrent networks for sequence modeling. arXiv:1803.01271, 2018.

[20] Van Den Oord A, Dieleman S, Zen H, et al. WaveNet: A generative model for raw audio. arXiv:1609.03499, 2016.

[21] Wu H, Xu J, Wang J, et al. Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting. NeurIPS, 2021, 34: 22419-22430.

[22] Zhou T, Ma Z, Wen Q, et al. FEDformer: Frequency enhanced decomposed transformer for long-term series forecasting. ICML, 2022: 27268-27286.

[23] Zadeh A, Chen M, Poria S, et al. Tensor fusion network for multimodal sentiment analysis. EMNLP, 2017: 1103-1114.

[24] Han W, Chen H, Poria S. Improving multimodal fusion with hierarchical mutual information maximization for multimodal sentiment analysis. EMNLP, 2021: 9180-9192.

[25] Koldijk S, Sappelli M, Verberne S, et al. The SWELL knowledge work dataset for stress and user modeling research. ICMI, 2014: 291-298.

[26] Kim H G, Cheon E J, Bai D S, et al. Stress and heart rate variability: a meta-analysis and review of the literature. Psychiatry Investigation, 2018, 15(3): 235-245.

[27] Taelman J, Vandeput S, Spaepen A, et al. Influence of mental stress on heart rate and heart rate variability. ECIFMBE, 2009: 1366-1369.

[28] Kendall A, Gal Y, Cipolla R. Multi-task learning using uncertainty to weigh losses for scene geometry and semantics. CVPR, 2018: 7482-7491.

[29] Wen Q, Zhou T, Zhang C, et al. Transformers in time series: a survey. IJCAI, 2023: 6778-6786.

[30] Biswas D, Simões-Capela N, Van Hoof C, et al. Heart rate estimation from wrist-worn photoplethysmography: A review. IEEE Sensors Journal, 2019, 19(16): 6560-6570.

[31] Giannakakis G, Grigoriadis D, Giannakaki K, et al. Review on psychological stress detection using biosignals. IEEE Transactions on Affective Computing, 2019, 13(1): 440-460.

[32] Elgendi M. On the analysis of fingertip photoplethysmogram signals. Current Cardiology Reviews, 2012, 8(1): 14-25.